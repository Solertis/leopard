"use strict";function run(e){for(var t=0;t<queue.length&&!(1>e);t++){for(var n=queue[t];n.length&&!(1>e);){counter--,e--;var i=n.shift();i&&"function"==typeof i&&i(),n.length||singletonEmitter.emit(t)}if(t===queue.length-1&&0===counter)return!1}return!0}function enqueue(e,t,n){if(n)for(;n--;)queue[e].push(t),counter++;else queue[e].push(t),counter++}function flush(){for(var e=0;levels>e;e++)queue[e].length=0;counter=0}function frame(e){if(isRunning){styleEnd=e,styleDuration=styleStart?styleEnd-styleStart:expectedFrame,scriptDuration=scriptEnd-scriptStart;var t=!0,n=!0;console.log(count),"batch"===strategy?(t=expectedFrame+1>scriptDuration,n=scriptDuration>=expectedFrame+1):(t=styleDuration>=expectedFrame&&expectedFrame+1>styleDuration&&0!==styleDuration,n=styleDuration>=expectedFrame+1),t?(accelerate*=perf,count+=accelerate):n&&(accelerate=1,count=Math.floor(count/2)),1>count&&(count=1),scriptStart=window.performance.now(),run(count),scriptEnd=window.performance.now(),styleStart=e,window.requestAnimationFrame(frame),window&&window.requestIdleCallback&&window.requestIdleCallback(function(e){if(e.timeRemaining()>0){var t=e.timeRemaining()/perFrame;run(Math.floor(count*t))}})}}function stop(){console.log("stop"),accelerate=1,count=limit,isRunning=!1,flush()}function start(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];isRunning||window.requestAnimationFrame(frame),e.limit&&(limit=count=e.limit),e.expectedFrame&&(expectedFrame=e.expectedFrame),e.strategy&&(strategy=e.strategy),e.perf&&(perf=e.perf),scriptStart=null,scriptEnd=null,styleStart=null,styleEnd=null,isRunning=!0}function put(e,t,n){enqueue(e,t,n)}function getCount(){return count}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},Emitter=function(){this.uid=0,this.handlers=[];for(var e=0;1e3>e;e++)this.handlers.push([])};Emitter.prototype.on=function(e,t){this.handlers[e].push({id:this.uid++,action:t})},Emitter.prototype.emit=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;t>i;i++)n[i-1]=arguments[i];this.handlers[e].forEach(function(e){"function"==typeof e.action&&e.action.apply(e,n)})},Emitter.prototype.once=function(e,t){var n=this,i=this.uid;this.on(e,function(){t.apply(void 0,arguments);var r=n.handlers[e].find(function(e){return e.id===i});n.handlers[e].splice(n.handlers[e].indexOf(r),1)})};var singletonEmitter=new Emitter;!function(){for(var e=0,t=["ms","moz","webkit","o"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,n){var i=(new Date).getTime(),r=Math.max(0,16-(i-e)),o=window.setTimeout(function(){t(i+r)},r);return e=i+r,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),function(){if("performance"in window==0&&(window.performance={}),Date.now=Date.now||function(){return(new Date).getTime()},"now"in window.performance==0){var e=Date.now();window.performance.timing&&window.performance.timing.navigationStart&&(e=window.performance.timing.navigationStart),window.performance.now=function(){return Date.now()-e}}}();for(var queue=[],counter=0,levels=1e3,i=0;levels>i;i++)queue.push([]);var perFrame=16,expectedFrame=perFrame,limit=1e3,count=limit,strategy="normal",perf=2,isRunning=!1,accelerate=1,scriptStart,scriptEnd,styleStart,styleEnd,styleDuration,scriptDuration,Leopard={on:singletonEmitter.on.bind(singletonEmitter),once:singletonEmitter.once.bind(singletonEmitter),start:start,stop:stop,put:put,get limit(){return getCount()}};"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=Leopard:"function"==typeof define&&"undefined"!=typeof define.amd?define(function(){return Leopard}):window.Leopard=Leopard;
//# sourceMappingURL=leopard.min.js.map
